(this.webpackJsonpgachawebsite=this.webpackJsonpgachawebsite||[]).push([[0],{29:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},35:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(22),i=a.n(s),c=a(13),o=a(7),l=a.n(o),h=a(21),d=a(14),u=a(8),p=a(9),j=a(11),m=a(10),b=a(16),g=a(2),f=(a(29),a(0)),v=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={dateObtained:n.props.dateObtained},n}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return Object(f.jsxs)("div",{className:"card",children:[Object(f.jsx)("h2",{children:this.props.character.name}),Object(f.jsx)("h4",{children:this.props.character.media}),Object(f.jsx)("p",{children:this.props.character.value}),Object(f.jsx)("img",{onClick:function(){return e.props.handleMediaSearch(e.props.character.mediaId)},src:this.props.character.image,alt:"Character"})]})}}]),a}(r.a.Component),C=(a(31),function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).renderCard=function(e){return Object(f.jsx)(v,{character:e,handleMediaSearch:n.props.handleMediaSearch},e.id)},n.renderSkippedCard=function(e){return Object(f.jsxs)("div",{className:"card-container",children:[Object(f.jsx)(v,{character:e,handleMediaSearch:n.props.handleMediaSearch}),Object(f.jsxs)("div",{className:"card-buttons",children:[Object(f.jsx)("button",{onClick:function(){return n.props.handleClaimSkipped(e)},children:"Claim"}),Object(f.jsx)("button",{onClick:function(){return n.props.handleRemoveSkipped(e)},children:"Remove"})]})]},e.id)},n.state={isCardTransitioning:!1,isInterfaceTransitioning:!1,onSkipPage:!1,currentCharacter:e.currentCharacter,nextCharacter:e.nextCharacter},n}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(e){e.currentCharacter!==this.props.currentCharacter&&(e.currentCharacter?this.setState({isCardTransitioning:!0}):this.setState({isCardTransitioning:!0,nextCharacter:this.props.currentCharacter}))}},{key:"onCardTransitionFinish",value:function(){this.state.isCardTransitioning&&this.setState({isCardTransitioning:!1,currentCharacter:this.props.currentCharacter,nextCharacter:this.props.nextCharacter})}},{key:"handleInterfaceClick",value:function(){this.setState({isInterfaceTransitioning:!0})}},{key:"onInterfaceTransitionFinish",value:function(){this.state.isInterfaceTransitioning&&this.setState({isInterfaceTransitioning:!1,onSkipPage:!this.state.onSkipPage})}},{key:"render",value:function(){var e=this,t=this.state.currentCharacter?this.renderCard(this.state.currentCharacter):null,a=this.state.nextCharacter?this.renderCard(this.state.nextCharacter):null,n=this.props.skippedCharacters.map(this.renderSkippedCard),r=this.state.currentCharacter||this.state.isCardTransitioning?null:Object(f.jsx)("button",{className:"reroll-button",onClick:this.props.handleReroll,children:"Reroll"}),s=this.state.isCardTransitioning?" is-transitioning":"",i=this.props.nextCharacter?"card next-card":"",c="",o="",l="";return this.state.isInterfaceTransitioning&&(c=this.state.onSkipPage?" is-entering":" is-leaving",o=this.state.onSkipPage?" is-leaving":" is-entering",l=this.state.onSkipPage?" to-rolls":" to-skips"),Object(f.jsxs)("div",{style:this.state.isInterfaceTransitioning?{overflow:"hidden"}:{},className:"roll-page",children:[Object(f.jsxs)("div",{className:"info-bar",children:[Object(f.jsx)("h1",{children:"Gacha Website"}),Object(f.jsxs)("h4",{className:"info-right-element",children:["$",this.props.totalMoney]})]}),Object(f.jsxs)("div",{style:this.state.onSkipPage&&!this.state.isInterfaceTransitioning?{display:"none"}:{},onAnimationEnd:function(){return e.onInterfaceTransitionFinish()},className:"rolls"+c,children:[Object(f.jsxs)("div",{className:"card-grid",children:[r,Object(f.jsx)("div",{onAnimationEnd:function(){return e.onCardTransitionFinish()},className:"current-card"+s,children:t}),Object(f.jsx)("div",{className:i}),a&&Object(f.jsxs)("div",{className:"next-card"+s,children:[Object(f.jsx)("div",{className:"card card-back"}),Object(f.jsx)("div",{className:"card-front",children:a})]})]}),Object(f.jsxs)("p",{children:["Cards remaining: ",this.props.numberRemainingCharacters]}),Object(f.jsxs)("div",{className:"roll-buttons",children:[Object(f.jsx)("button",{onClick:this.state.isCardTransitioning?null:this.props.handleClaim,children:"Claim"}),Object(f.jsx)("button",{onClick:this.state.isCardTransitioning?null:this.props.handleSkip,children:"Skip"})]})]}),Object(f.jsx)("button",{onClick:this.state.isCardTransitioning?null:function(){return e.handleInterfaceClick()},className:"switch-button"+(this.state.onSkipPage?" left":" right")+l,children:">"}),Object(f.jsxs)("div",{style:this.state.onSkipPage||this.state.isInterfaceTransitioning?{}:{display:"none"},className:"flex-list skips"+o,children:[n,Object(f.jsx)("div",{className:"info-bar option-bar",style:0===n.length?{display:"none"}:{},children:Object(f.jsx)("button",{className:"sub-button info-right-element",onClick:this.props.handleRemoveAllSkipped,style:{margin:"auto",marginRight:"10px"},children:"Remove All"})})]})]})}}]),a}(r.a.Component)),O=(a(32),function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).renderCard=function(e){return Object(f.jsxs)("div",{className:"card-container",children:[Object(f.jsx)(v,{character:e,handleMediaSearch:n.props.handleMediaSearch},e.id),Object(f.jsx)("div",{className:"card-buttons",children:Object(f.jsx)("button",{onClick:function(){return n.props.handleRemove(e)},children:"Remove"})})]},e.id)},n.handleSearch=function(e){if(e.target.value){var t=n.props.characters,a=e.target.value.toLowerCase(),r=t.filter((function(e){var t=e.name.toLowerCase(),n=e.media.toLowerCase();return t.includes(a)||n.includes(a)}));n.setState({searchResults:r,pageNum:0})}else n.setState({searchResults:null,pageNum:0})},n.handleClearSearch=function(){var e=document.getElementById("search-form");e.value="",e.dispatchEvent(new Event("input",{bubbles:!0}))},n.handleRemoveAll=function(){window.confirm("Remove all characters shown from collection?")&&(n.state.searchResults?(n.props.handleRemoveAllCollected(n.state.searchResults),n.handleClearSearch()):n.props.handleRemoveAllCollected(n.props.characters))},n.changePage=function(e){var t,a=n.state.pageNum,r=n.state.searchResults?Math.floor(n.state.searchResults.length/20)+1:Math.floor(n.props.characters.length/20)+1;0!==r&&("<"===e.target.innerText?t=(a-1+r)%r:">"===e.target.innerText&&(t=(a+1+r)%r),n.setState({pageNum:t}))},n.state={sortMethod:"Date Obtained",sortAscending:!0,searchResults:null,pageNum:0},n}return Object(p.a)(a,[{key:"renderSortButton",value:function(e){var t=this,a=this.state.sortAscending?Object(f.jsx)("p",{className:"sort-button-arrow",children:"\u2191"}):Object(f.jsx)("p",{className:"sort-button-arrow",children:"\u2193"}),n=Object(f.jsx)("p",{className:"sort-button-arrow"});return Object(f.jsxs)("button",{className:"sort-button option",onClick:function(){return t.changeSortMethod(e)},children:[Object(f.jsx)("p",{className:"sort-button-text",children:e}),this.state.sortMethod===e?a:n]})}},{key:"compareFields",value:function(e,t){return e>t?1:e===t?0:-1}},{key:"changeSortMethod",value:function(e){this.state.sortMethod===e?this.setState({sortAscending:!this.state.sortAscending}):this.setState({sortMethod:e,sortAscending:!0})}},{key:"render",value:function(){var e=this,t=this.state.searchResults?this.state.searchResults:this.props.characters;switch(this.state.sortMethod){case"Date Obtained":t.sort((function(t,a){return e.compareFields(Date.parse(t.dateObtained),Date.parse(a.dateObtained))}));break;case"Name":t.sort((function(t,a){return e.compareFields(t.name,a.name)}));break;case"Media":t.sort((function(t,a){return e.compareFields(t.media,a.media)}));break;case"Value":t.sort((function(t,a){return e.compareFields(t.value,a.value)}))}t=t.slice(20*this.state.pageNum,20*(this.state.pageNum+1)),this.state.sortAscending||t.reverse();var a=t.map(this.renderCard);return Object(f.jsxs)("div",{className:"collection-page",children:[Object(f.jsxs)("div",{className:"info-bar",children:[Object(f.jsx)("h1",{children:"Collection"}),Object(f.jsxs)("h4",{className:"info-right-element",children:["$",this.props.totalMoney]})]}),Object(f.jsxs)("div",{className:"info-bar option-bar",children:[Object(f.jsxs)("div",{className:"sort-container",children:[Object(f.jsx)("button",{className:"sort-button",children:"Sort"}),Object(f.jsxs)("div",{className:"sort-menu",children:[this.renderSortButton("Date Obtained"),this.renderSortButton("Name"),this.renderSortButton("Media"),this.renderSortButton("Value")]})]}),Object(f.jsxs)("div",{className:"search-form",children:[Object(f.jsx)("input",{type:"text",id:"search-form",placeholder:"Search",onInput:this.handleSearch}),Object(f.jsx)("button",{onClick:this.handleClearSearch,children:"Clear"})]}),Object(f.jsx)("div",{className:"remove-all-button",children:Object(f.jsx)("button",{className:"sub-button",onClick:this.handleRemoveAll,children:"Remove All"})}),Object(f.jsxs)("div",{className:"page-settings info-right-element",children:[Object(f.jsx)("button",{onClick:this.changePage,children:"<"}),Object(f.jsx)("span",{children:this.state.pageNum+1}),Object(f.jsx)("button",{onClick:this.changePage,children:">"})]})]}),Object(f.jsx)("div",{className:"flex-list",children:a}),Object(f.jsx)("div",{className:"info-bar option-bar",children:Object(f.jsxs)("div",{className:"page-settings info-right-element",children:[Object(f.jsx)("button",{onClick:this.changePage,children:"<"}),Object(f.jsx)("span",{children:this.state.pageNum+1}),Object(f.jsx)("button",{onClick:this.changePage,children:">"})]})})]})}}]),a}(r.a.Component)),x=(a(33),function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={isTransitioning:!1,media:null},n}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(e){e.media!==this.props.media&&this.setState({isTransitioning:!0,media:this.props.media?this.props.media:this.state.media})}},{key:"onTransitionFinish",value:function(){this.props.media?this.setState({isTransitioning:!1}):this.setState({isTransitioning:!1,media:null})}},{key:"render",value:function(){var e=this,t="";if(this.state.isTransitioning&&(t=this.props.media?" is-entering":" is-leaving"),this.state.media){var a=this.state.media.genres.join(", ");return Object(f.jsxs)("div",{onAnimationEnd:function(){return e.onTransitionFinish()},children:[Object(f.jsx)("div",{className:"dim-overlay"+t,onClick:this.state.isTransitioning?null:this.props.handleCloseSearch}),Object(f.jsxs)("div",{className:"search-card"+t,children:[Object(f.jsxs)("div",{className:"left-bar",children:[Object(f.jsx)("img",{src:this.state.media.image,alt:"Media"}),Object(f.jsx)("h2",{children:this.state.media.title}),Object(f.jsx)("p",{children:this.state.media.type}),Object(f.jsxs)("p",{children:["Genres: ",a]}),Object(f.jsxs)("p",{children:["Start Date: ",this.state.media.startDate]}),Object(f.jsxs)("p",{children:["End Date: ",this.state.media.endDate]})]}),Object(f.jsxs)("div",{className:"main-info",children:[Object(f.jsx)("p",{children:this.state.media.description}),Object(f.jsxs)("p",{children:["Score: ",this.state.media.averageScore]}),Object(f.jsxs)("p",{children:["Source: ",this.state.media.source]})]})]})]})}return null}}]),a}(r.a.Component)),S=a(34);function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a="\n        query ($id_in:[Int], $page:Int, $perPage:Int) {\n\t        Page(page:$page, perPage:$perPage) {\n                pageInfo {\n                    total\n                    perPage\n                    currentPage\n                    lastPage\n                    hasNextPage\n                }\n                characters (id_in:$id_in){\n                    id\n                    name {\n                        full\n                    }\n                    favourites\n                    image {\n                        large\n                    }\n                    media (perPage:1) {\n                        nodes {\n                            id\n                            title {\n                                romaji\n                            }\n                        }\n                    }\n  \t            }\n            }\n        }",n="https://graphql.anilist.co",r={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:a,variables:{id_in:e,page:t,perPage:50}})};return console.log("Call to API: Page"),S(n,r).then((function(e){return e.json()}))}function y(e){var t={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n        query ($id: Int) {\n            Media (id: $id) {\n                title {\n                    romaji\n                    english\n                    native\n                    userPreferred\n                }\n                description\n                startDate {\n                    year\n                    month\n                    day\n                }\n                endDate {\n                    year\n                    month\n                    day\n                }\n                type\n                status\n                genres\n                averageScore\n                popularity\n                source\n                id\n                coverImage {\n                    large\n                }\n            }\n        }",variables:{id:e}})};return console.log("Call to API: Media"),S("https://graphql.anilist.co",t).then((function(e){return e.json()}))}var N=localStorage.collection?JSON.parse(localStorage.collection):{};function M(){console.log("Generating characters");for(var e=new Set;e.size<100;){var t=Math.floor(229946*Math.random());e.has(t)||N.hasOwnProperty(t)||e.add(t)}return Array.from(e)}function R(e){console.log("Adding character to collection"),N.hasOwnProperty(e)||(N[e]={data:{dateObtained:new Date}})}function T(e){console.log("Removing character from collection"),delete N[e]}function w(e){var t=N[e.id]?N[e.id].data.dateObtained:null;return{id:e.id,name:e.name.full,media:e.media.nodes[0]?e.media.nodes[0].title.romaji:null,mediaId:e.media.nodes[0]?e.media.nodes[0].id:null,value:e.favourites,image:e.image.large,dateObtained:t}}function P(e){var t=new Date(Date.UTC(e.startDate.year,e.startDate.month-1,e.startDate.day+1)).toLocaleDateString(),a=new Date(Date.UTC(e.endDate.year,e.endDate.month-1,e.endDate.day+1)).toLocaleDateString();return{id:e.id,image:e.coverImage.large,title:e.title.romaji,description:e.description,type:e.type,genres:e.genres,averageScore:e.averageScore,startDate:t,endDate:a,source:e.source}}function D(e){console.log("Saving to storage"),localStorage.collection=JSON.stringify(N),localStorage.totalMoney=JSON.stringify(e.totalMoney)}a(35);var I=function(e){Object(j.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).updateRollBuffer=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(h.a)(n.state.rolledCharacterBuffer),e.next=3,k(t);case 3:r=e.sent,a=a.concat(r.data.Page.characters),console.log(a),n.setState({rolledCharacterBuffer:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleClaim=function(){var e=n.state.currentCharacter;if(e&&0!==Object.keys(e).length){var t=n.state.rolledCharacterStack.slice(),a=n.state.nextCharacter,r=t.pop(),s=Object(c.a)({},n.state.collectedCharacters);s[e.id]=Object(c.a)(Object(c.a)({},e),{},{dateObtained:new Date}),R(e.id),n.setState({rolledCharacterStack:t,currentCharacter:a,nextCharacter:r,collectedCharacters:s}),console.log("Claimed character: ".concat(e.id))}},n.handleSkip=function(){var e=n.state.currentCharacter;if(e&&0!==Object.keys(e).length){var t=n.state.rolledCharacterStack.slice(),a=n.state.skippedCharacterStack.slice(),r=n.state.nextCharacter,s=t.pop();a.push(e),n.setState({rolledCharacterStack:t,skippedCharacterStack:a,currentCharacter:r,nextCharacter:s}),console.log("Skipped character: ".concat(e.id))}},n.handleClaimSkipped=function(e){var t=n.state.skippedCharacterStack.filter((function(t){return t!==e})),a=Object(c.a)({},n.state.collectedCharacters);a[e.id]=Object(c.a)(Object(c.a)({},e),{},{dateObtained:new Date}),R(e.id),n.setState({skippedCharacterStack:t,collectedCharacters:a}),console.log("Claimed character: ".concat(e.id))},n.handleRemoveSkipped=function(e){var t=n.state.totalMoney+e.value,a=n.state.skippedCharacterStack.filter((function(t){return t!==e}));n.setState({skippedCharacterStack:a,totalMoney:t}),console.log("Removed character: ".concat(e.id))},n.handleRemoveAllSkipped=function(){var e=n.state.totalMoney;n.state.skippedCharacterStack.forEach((function(t){e+=t.value})),n.setState({skippedCharacterStack:[],totalMoney:e}),console.log("Removed all skipped characters")},n.handleReroll=function(){n.setRollCharacters(M()),console.log("Rerolling")},n.handleRemoveCollected=function(e){T(e.id);var t=Object.assign(n.state.collectedCharacters);delete t[e.id],n.setState({collectedCharacters:t}),console.log("Removed character: ".concat(e.id))},n.handleRemoveAllCollected=function(e){var t=Object.assign(n.state.collectedCharacters);e.forEach((function(e){T(e.id),delete t[e.id],console.log("Removed character: ".concat(e.id))})),n.setState({collectedCharacters:t})},n.handleMediaSearch=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:a=e.sent,r=P(a.data.Media),n.setState({searchMedia:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleCloseSearch=function(){n.setState({searchMedia:null})},n.state={currentCharacter:null,nextCharacter:null,rolledCharacterStack:[],rolledCharacterBuffer:[],skippedCharacterStack:[],collectedCharacters:{},searchMedia:null,totalMoney:0},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setRollCharacters(M()),this.setCollectedCharacters((console.log("Getting collected characters"),Object.keys(N))),this.setTotalMoney((console.log("Getting total money"),0|localStorage.totalMoney)),window.addEventListener("beforeunload",(function(t){D({totalMoney:e.state.totalMoney})}))}},{key:"setRollCharacters",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.state.rolledCharacterBuffer.length){e.next=5;break}return e.next=3,this.updateRollBuffer(t);case 3:e.next=6;break;case 5:this.state.rolledCharacterBuffer.length<20&&this.updateRollBuffer(t);case 6:a=Object(h.a)(this.state.rolledCharacterBuffer),n=a.slice(0,10),a=a.slice(10),r=[],n.forEach((function(e){var t=w(e);r.push({id:t.id,name:t.name,media:t.media,mediaId:t.mediaId,value:t.value,image:t.image})})),this.setState({currentCharacter:r.pop(),nextCharacter:r.pop(),rolledCharacterStack:r,rolledCharacterBuffer:a});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCollectedCharacters",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={},n=!0,r=1;case 3:if(!n){e.next=12;break}return e.next=6,k(t,r);case 6:(s=e.sent).data.Page.characters.forEach((function(e){var t=w(e);a[t.id]={id:t.id,name:t.name,media:t.media,mediaId:t.mediaId,value:t.value,image:t.image,dateObtained:t.dateObtained}})),n=s.data.Page.pageInfo.hasNextPage,r+=1,e.next=3;break;case 12:this.setState({collectedCharacters:a});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setTotalMoney",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({totalMoney:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(f.jsx)(b.a,{children:Object(f.jsxs)("div",{className:"app",children:[Object(f.jsxs)("div",{className:"navbar",children:[Object(f.jsx)(b.b,{to:"/",children:"Roll"}),Object(f.jsx)(b.b,{to:"/collection",children:"Collection"}),Object(f.jsx)(b.b,{onClick:D,children:"Save"})]}),Object(f.jsx)(x,{media:this.state.searchMedia,handleCloseSearch:this.handleCloseSearch}),Object(f.jsxs)(g.c,{children:[Object(f.jsx)(g.a,{exact:!0,path:"/",children:Object(f.jsx)(C,{currentCharacter:this.state.currentCharacter,nextCharacter:this.state.nextCharacter,numberRemainingCharacters:this.state.rolledCharacterStack.length+(this.state.currentCharacter?this.state.nextCharacter?2:1:0),skippedCharacters:this.state.skippedCharacterStack,totalMoney:this.state.totalMoney,handleClaim:this.handleClaim,handleSkip:this.handleSkip,handleClaimSkipped:this.handleClaimSkipped,handleRemoveSkipped:this.handleRemoveSkipped,handleRemoveAllSkipped:this.handleRemoveAllSkipped,handleReroll:this.handleReroll,handleMediaSearch:this.handleMediaSearch})}),Object(f.jsx)(g.a,{path:"/collection",children:Object(f.jsx)(O,{characters:Object.values(this.state.collectedCharacters),totalMoney:this.state.totalMoney,handleRemoveCollected:this.handleRemoveCollected,handleRemoveAllCollected:this.handleRemoveAllCollected,handleMediaSearch:this.handleMediaSearch})})]})]})})}}]),a}(r.a.Component);i.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(I,{})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.c39bb765.chunk.js.map